<table class="table cart-table">
  <thead>
    <tr>
      <th>
        <%= I18n.t(:item, scope: :cart) %>
      </th>
      <th>
        <%= I18n.t(:name, scope: :cart) %>
      </th>
      <th>
        <%= I18n.t(:variant_option, scope: :cart) %>
      </th>
      <th>
        <%= I18n.t(:quantity, scope: :cart) %>
      </th>
      <th>
        <%= I18n.t(:unit_price, scope: :cart) %>
      </th>
      <% unless @readonly %>
      <th>
        <%= I18n.t(:operations, scope: :cart) %>
      </th>
      <% end %>
    </tr>
  </thead>
  <tbody>
    <% order.order_items.each do |order_item| %>
    <tr>
      <td class="cart-item-image">
        <a href="<%= product_path(order_item.product) %>">
          <img src="<%= order_item.sku.decorate.image_url(:img0, :thumb) %>" class="icon-img"/>
        </a>
      </td>
      <td>
        <a href="<%= product_path(order_item.product) %>">
          <%= order_item.product.name %>
        </a>
      </td>
      <td>
        <%= select_tag :option_ids, grouped_options_for_select(order_item.product.decorate.grouped_variants_options, order_item.option_ids), {:multiple => 'multiple', :class => 'sku-variants-options'} %>
      </td>
      <td class="cart-item-quantity">

        <% unless @readonly %>
          <a href="#" class="js-set-quantity-minus" data-order-item-id="<%= order_item.id.to_s %>" data-order-shop-id="<%= s %>">
            <i class="fa fa-minus cart-item-minus"></i>
          </a>
        <% end %>

        <%= text_field_tag "", order_item.quantity, :id => "order-item-quantity-#{order_item.id.to_s}", :type => 'text', :value => "#{order_item.quantity}", :disabled => "disabled", :data => { :order_item_id => order_item.id.to_s } %>
        
        <% unless @readonly %>
          <a href="#" class="js-set-quantity-plus" data-order-item-id="<%= order_item.id.to_s %>" data-order-shop-id="<%= s %>">
            <i class="fa fa-plus cart-item-plus"></i>
          </a>
        <% end %>

      </td>
      <td>
        <%= order_item.order.decorate.is_bought? ? order_item.decorate.price_with_currency_yuan : order_item.sku.decorate.price_with_currency_yuan %>
        <% if order_item.sku.discount > 0 %>
          <span class="+discount"><%= order_item.sku.decorate.discount_with_percent %></span>
        <% end %>
      </td>
      <% unless @readonly %>
      <td class="cart-item-remove">

      <%= link_to '', guest_order_item_path(order_item), method: :delete, data: { confirm: I18n.t(:delete_sku_msg, :scope => :cart)  }, "data-placement" => "right",  class: 'fa fa-times' %>

      <!--
        <%= link_to '', '#', :class => 'fa fa-times', :onclick => "$('#cart-quantity-of-product-#{order_item.product.id}').val(0); $('#orders_adjust_products_amount').submit()" %>
      -->

      </td>
      <% end %>
    </tr>
    <% end %>
  </tbody>
</table>
<% unless @readonly %>
<%= link_to I18n.t(:set_delivery_destination, scope: :cart), set_address_orders_path(s), :class => 'btn btn-primary btn-small' %>
<% end %>