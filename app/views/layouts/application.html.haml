!!!
%html
  %head
    - if I18n.locale == :'zh-CN' or (current_user && current_user.role == :customer)
      %title 莱茵工场
    - else
      %title Rhein-Manufaktur

    %meta{:content => 'text/html; charset=utf-8', 'http-equiv' => 'Content-Type'}
    %meta{:content => '莱茵工场', :name => 'keywords'}
    %meta{:content => '莱茵工场', :name => 'description'}
    %meta{:content => 'Y. Liu', :name => 'author'}
    %meta{:content => 'width=device-width, initial-scale=1.0', :name => 'viewport'}

    = csrf_meta_tag

    = javascript_include_tag 'jquery.js'
    = javascript_include_tag 'jquery_ujs.js'
    = javascript_include_tag 'jquery-ui/widget.js'
    = javascript_include_tag 'jquery-ui/autocomplete.js'

    = javascript_include_tag 'validator.js'

    = javascript_include_tag 'leftmenu/script.js'

    = javascript_include_tag 'achat.js'

    = javascript_include_tag 'bootstrap-datepicker/core.js'
    = javascript_include_tag 'bootstrap-datepicker/locales/bootstrap-datepicker.zh-CN.js'
    = javascript_include_tag 'bootstrap-datepicker/locales/bootstrap-datepicker.de.js'

    = stylesheet_link_tag 'couponia/css/boostrap.css'
    = stylesheet_link_tag 'couponia/css/font_awesome.css'
    = stylesheet_link_tag 'couponia/css/styles.css'

    = stylesheet_link_tag 'couponia/css/mystyles.css'

    = stylesheet_link_tag 'leftmenu/style.css'

    = stylesheet_link_tag 'achat.css'

    = stylesheet_link_tag 'bootstrap-datepicker.css'


    - if session[:login_advice_counter].present?
      = hidden_field_tag :login_advice_counter, "#{session[:login_advice_counter]}"

    - if session[:signup_advice_counter].present?
      = hidden_field_tag :signup_advice_counter, "#{session[:signup_advice_counter]}"

    :javascript
      function validateImgFile(inputFile) {
        var maxExceededMessage = "#{I18n.t(:max_exceeded_message, scope: :image_upload)}";
        var extErrorMessage = "#{I18n.t(:ext_error_message, scope: :image_upload)}";;
        var allowedExtension = ["jpg", "jpeg", "png"];

        var extName;
        var maxFileSize = 1048576;
        var sizeExceeded = false;
        var extError = false;

        $.each(inputFile.files, function() {
          if (this.size && maxFileSize && this.size > maxFileSize) {sizeExceeded=true;};
          extName = this.name.split('.').pop();
          if ($.inArray(extName, allowedExtension) == -1) {extError=true;};
        });
        if (sizeExceeded) {
          window.alert(maxExceededMessage);
          $(inputFile).val('');
        };

        if (extError) {
          window.alert(extErrorMessage);
          $(inputFile).val('');
        };
      }

      #{generate_set_datepicker_lang_js}
  %body
    = render "layouts/header_#{!current_user ? 'default' : current_user.role.to_s}"

    - for_device_type :desktop, :tablet do
      .row{ :style => 'height:74px;margin-top:6px' }
        .col-md-4.pull-right
          - if flash[:error]
            .alert.alert-danger.fade.in{:role => 'alert'}
              %a.close{'aria-label' => 'close', 'data-dismiss' => 'alert', :href => '#'} &times;
              = flash[:error]
          - elsif flash[:info]
            .alert.alert-info.fade.in{:role => 'alert'}
              %a.close{'aria-label' => 'close', 'data-dismiss' => 'alert', :href => '#'} &times;
              = flash[:info]
          - elsif flash[:warning]
            .alert.alert-warning.fade.in{:role => 'alert'}
              %a.close{'aria-label' => 'close', 'data-dismiss' => 'alert', :href => '#'} &times;
              = flash[:warning]
          - elsif flash[:success]
            .alert.alert-success.fade.in{:role => 'alert'}
              %a.close{'aria-label' => 'close', 'data-dismiss' => 'alert', :href => '#'} &times;
              = flash[:success]

    .container{:style => 'height:80%'}
      = yield

    .gap

    = render "layouts/footer_#{!current_user ? 'default' : current_user.role.to_s}"

  = javascript_include_tag 'couponia/boostrap.min.js'
  = javascript_include_tag 'couponia/countdown.min.js'
  = javascript_include_tag 'couponia/flexnav.min.js'
  = javascript_include_tag 'couponia/magnific.js'
  = javascript_include_tag 'couponia/tweet.min.js'
  = javascript_include_tag 'couponia/fitvids.min.js'
  = javascript_include_tag 'couponia/mail.min.js'
  = javascript_include_tag 'couponia/ionrangeslider.js'
  = javascript_include_tag 'couponia/icheck.js'
  = javascript_include_tag 'couponia/fotorama.js'
  = javascript_include_tag 'couponia/card-payment.js'
  = javascript_include_tag 'couponia/owl-carousel.js'
  = javascript_include_tag 'couponia/masonry.js'
  = javascript_include_tag 'couponia/nicescroll.js'
  = javascript_include_tag 'couponia/custom.js'
