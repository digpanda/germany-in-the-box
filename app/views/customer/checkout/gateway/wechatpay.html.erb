<!-- TODO : move this into the javascript area -->
<script>

function onBridgeReady(){
  WeixinJSBridge.invoke(
    'getBrandWCPayRequest', {
      "appId": "<%= @checkout[:javascript_pay_request][:appId] %>",
      "timeStamp": "<%= @checkout[:javascript_pay_request][:timeStamp] %>",
      "nonceStr": "<%= @checkout[:javascript_pay_request][:nonceStr] %>",
      "package": "<%= @checkout[:javascript_pay_request][:package] %>",
      "signType": "<%= @checkout[:javascript_pay_request][:signType] %>",
      "paySign": "<%= @checkout[:javascript_pay_request][:paySign] %>"
    },
    function(res){
      alert(res.err_msg);
      if(res.err_msg == "get_brand_wcpay_requestï¼šok" ) {}
    }
  );
}
if (typeof WeixinJSBridge == "undefined"){

  if( document.addEventListener ){
    document.addEventListener('WeixinJSBridgeReady', onBridgeReady, false);
  } else if (document.attachEvent){
    document.attachEvent('WeixinJSBridgeReady', onBridgeReady);
    document.attachEvent('onWeixinJSBridgeReady', onBridgeReady);
  }

} else{
  onBridgeReady();
}

</script>
