<tr>
  <td>
    <%= order_payment.request_id %>
  </td>
  <td>
    <% if order_payment.transaction_id %>
    <%= order_payment.transaction_id %>
    <% #else %>

      <%= form_tag admin_order_payment_transaction_id_path(order_payment), method: :patch do %>
        <%= text_field_tag :transaction_id %>
        <%= submit_tag "Update" %>
      <% end %>

    <% end %>
  </td>
  <td>
    <%= link_to order_payment.shop.name, edit_producer_shop_path(order_payment.shop, :user_info_edit_part => :edit_shops) %>
  </td>
  <td>
    <%= link_to order_payment.order_id, order_path(order_payment.order_id) %>
  </td>
  <td>
    <% unless order_payment&.order&.shipping_address.nil? %>
    <%= order_payment.order.shipping_address.decorate.chinese_full_name %>
    <% end %>
  </td>
  <td>
    <%= order_payment.status %>
  </td>
  <td>
    <%= order_payment.order.user.decorate.full_name if order_payment.order&.user %>
  </td>
  <td>
    <%= order_payment.decorate.amount_cny_with_currency %>
  </td>
  <td>
    <%= order_payment.decorate.amount_eur_with_currency %>
  </td>
  <td>
    <%= order_payment.payment_method %>
  </td>
  <td>
    <%= order_payment.transaction_type %>
  </td>
  <td>
    <%= order_payment.c_at.strftime('%Y-%m-%d %H:%M:%S').in_time_zone %>
  </td>
  <td>
    <% if order_payment.unverified? %>
      <%= link_to '', admin_order_payment_check_path(order_payment), :method => :post, data: { confirm: "Are you sure you want to refresh this order from the Elastic API ?" }, :class => 'fa fa-magic fa-2x', :title => "Check remotely" %>
    <% end %>
    <% if order_payment.refundable? %>
      <%= link_to '', admin_order_payment_refund_path(order_payment), :method => :post, data: { confirm: "Are you sure you want to refund this transaction ?" }, :class => 'fa fa-reply fa-2x', :title => "Refund" %>
    <% end %>
      <%= link_to '', admin_order_payment_path(order_payment), :method => :delete, data: { confirm: "Are you sure you want to remove a transaction ? This cannot be undone." }, :class => 'fa fa-times-circle fa-2x', :title => "Remove" %>
  </td>
</tr>
